희소행렬
===

## 1. 희소행렬 이해
- 모든 문서에 있는 단어를 추출해 이를 피처로 벡터화하는 방법은 필연적으로 많은 피처 칼럼을 만들 수밖에 없음. 모든 문서에 있는 단어를 중복 제거 후 피처로 만들면 일반적으로 수만 개에서 수십 만개의 단어가 만들어짐
- 이러한 대규모의 행렬이 생성되더라도 레코드의 각 문서가 가지는 단어의 수는 제한적이기 때문에 이 행렬의 값은 대부분 0이 차지할 수밖에 없음
- 이처럼 대규모 행렬의 대부분 값을 0이 차지하는 행렬을 가리켜 희소 행렬이라고 함
- BOW 형태를 가진 언어 모델의 피처 벡터화는 대부분 희소 행렬임. 이 경우 너무 많은 0 값이 메모리 공간에 할당되어 많은 메모리 공간이 필요하고, 연산 시에도 데이터 액세스를 위한 많은 시간이 소모됨
- 따라서 이러한 희소 행렬을 물리적으로 적은 메모리 공간을 차지할 수 있도록 변환해야 하는데, 대표적으로 COO 형식과 CSF 형식이 있음
- 일반적으로 __큰 희소 행렬을 저장하고 계산을 수행하는 능력이 CSR 형식이 더 뛰어나기 때문에 CSR을 많이 사용함__    
![image](https://github.com/seungye-kwak/til_log/assets/112370282/7d670d2d-a243-49ce-9c25-f029ceb1d15a)

### 1.1 COO 형식 (Coordinate: 좌표)
- 0이 아닌 데이터만 별도의 데이터 배열(Array)에 저장하고, 그 데이터가 가리키는 행과열의 위치를 별도의 배열로 저장하는 방식
- 예를 들어 [ [3, 0, 1], [0, 2, 0] ] 과 같은 2차원 데이터가 있다고 할 때 0이 아닌 데이터 위치를 (row, col)로 표현하면 (0,0), (0,2), (1,1)이 됨. 로우와 컬럼을 별도의 배열로 저장하면 로우는 [0, 0, 1], 칼럼은 [0, 2, 1]이 됨
- 파이썬 세계에서는 희소 행렬 변환을 위해서 주로 사이파이(Scipy)를 이용함. 사이파이의 sparse를 이용해 희소 행렬 변환을 COO 형식으로 하면 아래와 같음
  ```python
  import numpy as np

  dense = np.array( [[3,0,1], [0, 2, 0]])

  from scipy import sparse

  # 0이 아닌 데이터 추출
  data = np.array([3, 1, 2])

  # 행 위치와 열 위치를 각각 배열로 생성
  row_pos = np.array([0, 0, 1])
  col_pos = np.array([0, 2, 1])

  # sparse 패키지의 coo_matrix를 이용해 COO 형식으로 희소 행렬 생성
  sparse_coo = sparse.coo_matrix((data, (row_pos, col_pos)))
  sparse_coo.toarray()
  ```

### 1.2 CSR 형식


